% arara: pdflatex: { shell: yes }
% arara: pythontex: {verbose: yes, rerun: modified }
% arara: pdflatex: { shell: yes }

\documentclass[assignments]{subfiles}

\begin{document}


\section{Assignment 1}
\label{sec:org9cbca82}


\subsection{Have you read well?}
\label{sec:have-you-read}


\begin{exercise}
In your own words, explain what is
\begin{enumerate}
\item a joint PMF, PDF, CDF;
\item a conditional PMF, PDF, CDF;
\item a marginal PMF, PDF, CDF.
\end{enumerate}
\end{exercise}

\begin{exercise}
We have two r.v.s $X, Y \in [0,1]^{2}$ with the joint PDF $f_{X,Y}(x,y) = 2 \1{x\leq y}$? 
\begin{enumerate}
\item Are $X$ and $Y$ independent? 
\item Compute $F_{X,Y}(x,y)$. 
\end{enumerate}
\end{exercise}

\begin{exercise}
Correct (that is, is the following clam correct?)?
We have two continuous r.v.s $X, Y$.
Even though the joint CDF factors into the product of the marginals, i.e., $F_{X,Y}(x,y) = F_X(x)F_Y(y)$, it is still possible in general that the joint PDF does not factor into a product of marginals PDFs of $X$ and $Y$, i.e., $f_{X,Y}(x,y) \neq f_X(x) f_Y(y)$.
\end{exercise}

\begin{exercise}
Express Bayes' formula for two rvs $X$ and $Y$ in terms of the joint CDF, i.e., provide a formula.
\end{exercise}

\begin{exercise}
Let $X$ be uniformly distributed on the set $\{0,1,2\}$ and let $Y \sim \Bern{1/4}$; $X$ and $Y$ are independent.
Present a contingency table for the $X$ and $Y$.
What is the interpretation of the column sums the table?
What is the interpretation of the row sums of the table? Suppose you change some of the entries in the table, are $X$ and $Y$ still independent?
\end{exercise}

\begin{exercise}
Apply the chicken-egg story.
A machine makes items on a day.
Some items, independent of the other items, are failed (i.e., do not meet the quality requirements).
What is $N$, what is $p$, what are the `eggs' in this context, and what is the meaning of `hatching'?
What type of `hatching' do we have here?
\end{exercise}

\begin{exercise}
Apply the chicken-egg story. Families enter a zoo in a given hour. Some families have one child, other two, and so on. 
What are the `eggs' in this context, and what is the meaning of `hatching'? 
\end{exercise}


\begin{exercise}
Claim: We have two rvs $X$ and $Y$ on $\R^{+}$. It is given that $F_{X,Y}(x,y) = F_X(x)F_Y(y)$ for $x,y \leq 1/3$. Then  $X$ and $Y$ are necessarily independent. 
\end{exercise}

\begin{exercise}
I select a random guy from the street, his height $X\sim\Norm{1.8, 0.1}$, and I select a random woman from the street, her height is $Y\sim\Norm{1.7, 0.08}$.
I claim that since I selected the man and the woman independently, their heights are independent.
Briefly comment on this claim.
(Hint, from this exercise you should memorize this: \textbf{independence is a property of the joint CDF, not of the rvs}.)
\end{exercise}


\begin{exercise}
Correct? For any two rvs $X$ and $Y$ on $\R^{+}$ with marginals $F_{X}$ and $F_{Y}$. Then $\P{X\leq x, Y\leq y} = F_{X}(x) F_{Y}(x)$.
\end{exercise}

\begin{exercise}
Theorem 7.1.11. What is the meaning of the notation $X|N=n$?
\end{exercise}

\begin{exercise}
Correct? $X, Y$ two discrete rvs with CDF $F_{X,Y}$. We can compute the PDF as $\partial_{x}\partial_{y} F_{X,Y}(x,y)$.
\end{exercise}


\subsection{Exercises at about exam level}
\label{sec:below-exam-level}



\begin{exercise}\label{ex:1}
We throw an unbiased die with six sides; the result of the $i$th throw is $X_i$. 
\begin{enumerate}
\item What is the sample space of the two throws $(X_{1}, X_2)$?
\item What is the joint CDF?
\item What is the joint PMF?
\item  Marginalize out $X_2$ to show that $\P{X_1=5} = 1/6$.
\item Use the fundamental bridge and indicators to compute $\P{X_1>X_2}$.
\item Use the fundamental bridge and indicators to compute $\P{|X_1-X_2| < 1 } = 1/6$.
\item Use the fundamental bridge and indicators to compute $\P{|X_1-X_2|\leq 1 }$.
\item How would you use simulation to estimate  $\P{|X_1-X_2|\leq 1 }$?
\end{enumerate}
\end{exercise}

\begin{exercise}
We select a random married couple (a man and a woman). His height is $X\sim \Norm{1.8, 0.1}$, her height is $Y\sim \Norm{1.7, 0.08}$ in meters. 
\begin{enumerate}
\item What is the sample space of $(X, Y)$?
\item If your answer to question 1 is correct, you must have noticed that potentially the height of the man and the woman can be negative. Is this a problem for this model? 
\item What is the joint CDF?
\item What is the joint PDF?
\item  Marginalize out $Y$ to show that $X\sim \Norm{1.8, 0.1}$.
\item Use the fundamental bridge and indicators to write  $\P{X>Y}$ as an integral. You don't have to solve the integral.
\item Use the fundamental bridge and indicators to write  $\P{|X-Y| < 0.1 }$ as an integral. You don't have to solve the integral.
\end{enumerate}
\end{exercise}

\begin{exercise}
This is about the simplest model for an insurance company that I can think of.
We start with an initial capital $I_0=2$.
The company receives claims and contributions every period, a week say.
In the $i$th period, we receive a contribution $X_{i}$ uniform on the set $\{1, 2,\ldots,10\}$ and a claim $C_i$ uniform on $\{0, 1, \ldots 8\}$.
\begin{enumerate}
\item What is the interpretation of $\bar I_{n} = \min{I_{i} : 0\leq i\leq n}$? 
\item What is the meaning of $I_1=I_0+X_1-C_1$?
\item What is the meaning of $I_2=I_1+X_2-C_2$?
\item What is the interpretation of $I_1'=\max{I_0-C_1,0} + X_1$?
\item What is the interpretation of $I_2'=\max{I_1'-C_2,0} + X_2$?
\item What is  $\P{I_1 < 0}$?
\item What is  $\P{I_1' < 0}$?
\item What is  $\P{I_2 < 0}$?
\item What is  $\P{I_2' < 0}$?
\item Provide an interpretation in terms of the inventory of rice, say, at a supermarket for $I_{1}$ and $I_{1}'$.
\end{enumerate}
\end{exercise}



\begin{exercise} %wk
Assume that $X$ has the Cauchy distribution. 
\begin{enumerate}
\item Does $\E{\frac{X}{X^2+1}}$ exist? If so, find its value. 
\item Does $\E{\frac{|X|}{X^2+1}}$ exist? If so, find its value. 
\end{enumerate}
\end{exercise}


\subsection{Coding skills}
\label{sec:coding-skills}



\begin{exercise} 
Use simulation to estimate the answer of BH.7.1. Run the code below and explain line 9 of python code or line 7 of the R code. 


Then run the code for a larger sample, e.g, \verb|num=1000| or so, but remove the prints of \verb|a|, \verb|b|, and \verb|succes|, because that will fill your screen with numbers you don't need.
Only for small simulations such output is handy so that you can check the code.

Compare the value of the simulation to the exact value.


\begin{minted}[]{python}
import numpy as np

np.random.seed(3)

num = 10

a = np.random.uniform(size=num)
b = np.random.uniform(size=num)
success = np.abs(a - b) < 0.25
print(a)
print(b)
print(success)
print(success.mean(), success.var())
\end{minted}


\begin{minted}[]{R}
set.seed(3)

num <- 10

a <- runif(num)
b <- runif(num)
success <- abs(a-b) < 0.25
a
b
success
paste(mean(success), var(success))
\end{minted}

Challenge (not obligatory): If you like, you can include a plot of the region (in time) in which Alice and Bob meet, and put marks on the points of the simulation that were `successful'. 
\end{exercise}



\begin{exercise}
Let $X\sim\Exp{3}$.
Find a simple expression for $\P{1 < X \leq 4}$ and compute the value.
Then use simulation to check this value.
Finally, use numerical integration to compute this value. What are the numbers? Explain lines 11, 21 and 26 of the python code or lines 7, 17 and 23 of the R code.

\begin{minted}[]{python}
import numpy as np
from scipy.stats import expon
from scipy.integrate import quad

labda = 3

X = expon(scale=1 / labda).rvs(1000)
# print(X)
print(X.mean())

success = (X > 1) * (X < 4)
# print(success)
print(success.mean(), success.std())


def F(x):  # CDF
    return 1 - np.exp(-labda * x)


def f(x):  # density
    return labda * np.exp(-labda * x)


print(F(4) - F(1))

I = quad(f, 1, 4)
print(I)
\end{minted}



\begin{minted}[]{R}
labda <- 3

X <- rexp(1000, rate = labda)
# X
mean(X)

success <- (X > 1) * (X < 4)
# print(success)
paste(mean(success), sd(success))


CDF <- function(x) {  # CDF
  return(1 - exp(-labda * x))
}

f <- function(x) {    # density
  return(labda * exp(-labda * x))
}


CDF(4) - CDF(1)

I = integrate(f, 1, 4)
I
\end{minted}


\end{exercise}


\subsection{Challenges}
\label{sec:above-exam-level}

\begin{exercise} %wk
Consider the again the chicken-egg story (BH 7.1.9): A chicken lays a random number of eggs $N$ an each egg independently hatches with probability $p$ and fails to hatch with probability $q = 1-p$.
For $N \sim \Pois{\lambda}$ it is shown in BH 7.1.9 that $X$ and $Y$ are independent and $X\sim\Pois{\lambda p}$ and $Y\sim\Pois{\lambda(1-p)}$. 
This exercise asks for the converse.

Let $X\sim\Pois{\lambda}$ be the number of eggs that hatch and let $Y\sim\Pois{\mu}$ be the number of eggs that do not hatch.
Assume that $X$ and $Y$ are independent.
Prove  $X+Y =: N \sim \Pois{\lambda + \mu}$.
\end{exercise}

\end{document}

\subsection{TODO for another year}

Here are some ideas for another time. You can neglect this. 

\begin{exercise}
For another time: afrondregels, bijv \(2.11*3= 6\), omdat \(3\) maar op 1 digit bekend is. Wat is de kwaliteit van deze afrondregel?
More generally,  check density for sum,product, and ratio of two normal (or other distributions)  by means of simulations.
\end{exercise}

